---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Регистрация" description="Создайте аккаунт">
	<section class="mx-auto flex max-w-md flex-col gap-4 px-4 py-12 sm:py-16">
		<header class="space-y-2">
			<p class="text-xs uppercase tracking-[0.2em] text-slate-500">Аккаунт</p>
			<h1 class="text-3xl font-bold text-slate-900">Регистрация</h1>
			<p class="text-sm text-slate-600">Укажите email и пароль (минимум 8 символов).</p>
		</header>
		<form id="signup-form" class="space-y-3 rounded-2xl border border-slate-200 bg-white p-4 shadow-[0_1px_0_#e2e8f0]">
			<label class="flex flex-col gap-1 text-sm text-slate-700">
				<span>Email</span>
				<input id="email" type="email" required class="rounded-lg border border-slate-200 px-3 py-2 text-sm" />
			</label>
			<label class="flex flex-col gap-1 text-sm text-slate-700">
				<span>Пароль</span>
				<input id="password" type="password" required minlength="8" class="rounded-lg border border-slate-200 px-3 py-2 text-sm" />
			</label>
			<button
				type="submit"
				class="w-full rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-slate-800 active:translate-y-[1px]"
			>
				Создать аккаунт
			</button>
			<p id="error" class="text-xs text-rose-600 hidden">Ошибка регистрации</p>
			<p class="text-xs text-slate-500">
				Уже есть аккаунт?
				<a href="/login" class="text-slate-900 font-semibold">Войти</a>
			</p>
		</form>
	</section>

	<script type="module">
		const form = document.getElementById('signup-form');
		const email = document.getElementById('email');
		const password = document.getElementById('password');
		const errorEl = document.getElementById('error');

		form.addEventListener('submit', async (e) => {
			e.preventDefault();
			errorEl.classList.add('hidden');
			const res = await fetch('/api/auth/signup', {
				method: 'POST',
				headers: { 'content-type': 'application/json' },
				body: JSON.stringify({ email: email.value, password: password.value })
			});
			if (!res.ok) {
				errorEl.classList.remove('hidden');
				return;
			}
			window.location.href = '/dashboard';
		});
	</script>
</BaseLayout>






